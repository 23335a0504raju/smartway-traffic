# Smart Way Traffic ğŸš¦

**Smart Way Traffic** is an intelligent, AI-powered traffic management system designed to analyze traffic flow in real-time, detect congestion, and identify emergency situations (accidents, fires, rollovers) using computer vision and Generative AI. 

The system provides a comprehensive dashboard for city planners and traffic controllers, featuring live video analysis, forensic accident reporting via Google Gemini, and realistic traffic flow simulations using Eclipse SUMO.

---

## ğŸš€ Key Features

*   **Real-Time Visualization**: Live video processing with YOLOv8 to track vehicle counts (Cars, Buses, Trucks, Motorcycles) and signal status.
*   **AI-Powered Forensics**: Automated accident analysis using **Google Gemini 2.5 Flash**. Generates detailed HTML reports and SMS summaries for detected incidents (Fire, Rollovers, Collisions).
*   **Intelligent Alerting**: Immediate multi-channel notifications via **Email (NodeMailer)** and **WhatsApp (Twilio)** when emergencies are detected.
*   **Traffic Simulation**: Integration with **Eclipse SUMO** to simulate traffic scenarios and optimize signal timings.
*   **Historical Analytics**: Supabase (PostgreSQL) backend to store and visualize long-term traffic data and incident logs.

---

## ğŸ› ï¸ Technology Stack

### **Frontend**
*   **Framework**: React (Vite)
*   **Styling**: Tailwind CSS
*   **Charts**: Recharts / Chart.js
*   **State**: React Hooks & Context API

### **Backend (API)**
*   **Runtime**: Node.js (Express)
*   **Database**: Supabase (PostgreSQL)
*   **AI Integration**: Google Generative AI SDK (Gemini 2.5 Flash)
*   **Communication**: Axios (HTTP), Twilio (WhatsApp), Nodemailer (Email)

### **AI Engine (Vision)**
*   **Language**: Python 3.11+
*   **Framework**: FastAPI
*   **Models**: Ultralytics YOLOv8 (Tracking & Detection)
*   **Simulation**: Eclipse SUMO (Traffic Control logic)
*   **Streaming**: SSE (Server-Sent Events) for real-time frontend updates

---

## ğŸ“‚ Project Structure

```text
smartway-traffic/
â”œâ”€â”€ ai_engine/           # Python Service (YOLOv8 + SUMO + FastAPI)
â”‚   â”œâ”€â”€ detector.py      # Core Computer Vision logic & Accident State Machine
â”‚   â”œâ”€â”€ main.py          # FastAPI Server & SSE Routes
â”‚   â””â”€â”€ sumo_sim/        # SUMO Simulation Configs
â”œâ”€â”€ backend/             # Node.js Service (Express + Gemini + Supabase)
â”‚   â”œâ”€â”€ index.js         # API Endpoints & Forensic Report Generation
â”‚   â””â”€â”€ schema.sql       # Database Schema
â””â”€â”€ smarttraffic-frontend/ # React Client
    â”œâ”€â”€ src/pages/       # Dashboard, Simulation & Analytics Pages
    â””â”€â”€ src/components/  # Reusable UI Components
```

---

## âš¡ Getting Started

### Prerequisites
1.  **Node.js** (v18+) & **npm**
2.  **Python** (v3.11+)
3.  **PostgreSQL / Supabase Account**
4.  **Google Gemini API Key** (for forensic reports)

### 1. Database Setup (Supabase)
1.  Create a new Supabase project.
2.  Go to the **SQL Editor** and run the contents of `backend/schema.sql`.
3.  Note down your `SUPABASE_URL` and `SUPABASE_KEY` (Anon Key).

### 2. Backend Setup
```bash
cd backend
npm install
```
Create a `.env` file in `backend/`:
```env
PORT=5000
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_anon_key
GEMINI_API_KEY=your_google_gemini_key
# Optional for Alerts
EMAIL_USER=your_gmail_address
EMAIL_PASS=your_gmail_app_password
TWILIO_SID=your_twilio_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=your_twilio_phone
ALERT_DESTINATION_PHONE=recipient_phone_number
```
Start the backend:
```bash
node index.js
```

### 3. AI Engine Setup
```bash
cd ai_engine
# Create virtual environment (recommended)
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

pip install -r requirements.txt
```
Create a `.env` in `ai_engine/` (optional, mostly handled by backend):
```env
# If specialized API keys are needed
```
Start the AI microservice:
```bash
python main.py
```
*The AI Engine runs on `http://localhost:8000`.*

### 4. Frontend Setup
```bash
cd smarttraffic-frontend
npm install
npm run dev
```
*The frontend runs on `http://localhost:5173`.*

---

## ğŸš¦ Usage Workflow

1.  **Dashboard**: Upload traffic footage via the web interface.
2.  **Simulation Page**: Select a video and click **"Visualize"**.
    *   The system streams processed frames with bounding boxes.
    *   Accidents/Violations are flagged in real-time.
3.  **Analysis**: Upon completion/stopping, the system captures a "Busiest Frame" snapshot.
4.  **Reporting**: A Forensic Report is automatically generated by Gemini and saved to the database. Check the **History** or **Alerts** page to view the report.

---

## ğŸ¤ Contributors
*   **Smart Way Traffic Team**

## ğŸ“„ License
This project is licensed under the MIT License.
